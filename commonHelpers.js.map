{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\niziToast.settings({\n  position: \"topRight\",\n  timeout: 5000,\n  resetOnHover: true,\n  transitionIn: \"flipInX\",\n  transitionOut: \"flipOutX\"\n});\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nconst API_KEY = \"41671607-e33db59ab0332d081087354c8\";\nconst API_URL = \"https://pixabay.com/api/?\";\n\nconst reqParams = {\n  key: API_KEY,\n  orientation: \"horizontal\",\n  image_type: \"photo\",\n  safesearch: true,\n  per_page: 40,\n  page: 1,\n  q: \"\"\n};\n\nconst form = document.querySelector(\".search-form\");\nconst loader = document.querySelector(\"div[data-loader='search']\");\nconst gallery = document.querySelector(\".gallery\");\nconst btnLoadMore = document.querySelector(\"button[data-pagination]\");\nconst loaderLoadMore = document.querySelector(\"div[data-loader='pagination']\");\nconst btnGoUp = document.querySelector(\"button[data-goup]\");\n\nform.addEventListener(\"submit\", onSearch);\nbtnLoadMore.addEventListener(\"click\", onPagination);\nbtnGoUp.addEventListener(\"click\", () => window.scrollTo({top:  0, behavior: 'smooth'}));\n\nfunction onSearch(e) {\n  e.preventDefault();\n\n  const searchStr = form.elements.searchStr.value.trim();\n  form.reset();\n\n  if (!searchStr) {\n    iziToast.error({ message: \"Search field cannot be empty!\" });\n    return;\n  }\n\n  gallery.innerHTML = \"\";\n  loader.style.display = \"block\";\n  btnLoadMore.style.display = \"none\";\n  btnGoUp.style.display = \"none\";\n\n  reqParams.q = searchStr;\n  reqParams.page = 1;\n  performAPI(reqParams)\n}\n\nfunction onPagination() {\n  loaderLoadMore.style.display = \"block\";\n  performAPI(reqParams);\n}\n\nasync function performAPI(params) {\n  try {\n    const images = await axios.get(API_URL, { params })\n          .then(({ data }) => data);\n\n    if (images.hits.length == 0) {\n      iziToast.warning({ message: \"Sorry, there are no images matching<br> your search query.Please try again!\" });\n      return;\n    }\n    updateGalleryMarkup(images.hits);\n    performPagination(images.totalHits);\n\n  } catch (error) {\n    iziToast.error({ message: `Api request error: ${error}` })\n\n  } finally {\n    loader.style.display = \"none\";\n    loaderLoadMore.style.display = \"none\";\n  }\n}\n\nfunction performPagination(imgCount) {\n  if (imgCount <= reqParams.per_page * reqParams.page) {\n    btnLoadMore.style.display = \"none\";\n    btnGoUp.style.display = \"block\";\n    iziToast.warning({ message: \"We're sorry, but you've reached the end of search results.\" });\n\n  } else {\n    reqParams.page += 1;\n    btnLoadMore.style.display = \"block\";\n  }\n\n  if (reqParams.page > 2) {\n    const elHeight = gallery.children[0].getBoundingClientRect().height;\n    window.scrollBy({ left:0, top: elHeight * 2 + 12, behavior: 'smooth'});\n  }\n}\n\nfunction updateGalleryMarkup(images) {\n  gallery.insertAdjacentHTML(\"beforeend\", images.map(fillGalleryCard).join(\"\"));\n  lightbox.refresh();\n}\n\nconst fillGalleryCard = ({\n  largeImageURL,\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <div class=\"item-wrap\">\n          <div class=\"image-wrap\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          </div>\n          <ul class=\"metabox-list\">\n            <li class=\"mbox-info\">\n              <p class=\"mbox-info-title\">Likes</p>\n              <span class=\"mbox-info-descr\">${likes}</span>\n            </li>\n            <li class=\"mbox-info\">\n              <p class=\"mbox-info-title\">Views</p>\n              <span class=\"mbox-info-descr\">${views}</span>\n            </li>\n            <li class=\"mbox-info\">\n              <p class=\"mbox-info-title\">Comments</p>\n              <span class=\"mbox-info-descr\">${comments}</span>\n            </li>\n            <li class=\"mbox-info\">\n              <p class=\"mbox-info-title\">Downloads</p>\n              <span class=\"mbox-info-descr\">${downloads}</span>\n            </li>\n          </ul>\n        </div>\n      </a>\n    </li>`;\n};"],"names":["iziToast","lightbox","SimpleLightbox","API_KEY","API_URL","reqParams","form","loader","gallery","btnLoadMore","loaderLoadMore","btnGoUp","onSearch","onPagination","e","searchStr","performAPI","params","images","axios","data","updateGalleryMarkup","performPagination","error","imgCount","elHeight","fillGalleryCard","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"+vBAMAA,EAAS,SAAS,CAChB,SAAU,WACV,QAAS,IACT,aAAc,GACd,aAAc,UACd,cAAe,UACjB,CAAC,EAED,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAU,qCACVC,EAAU,4BAEVC,EAAY,CAChB,IAAKF,EACL,YAAa,aACb,WAAY,QACZ,WAAY,GACZ,SAAU,GACV,KAAM,EACN,EAAG,EACL,EAEMG,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAS,SAAS,cAAc,2BAA2B,EAC3DC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,yBAAyB,EAC9DC,EAAiB,SAAS,cAAc,+BAA+B,EACvEC,EAAU,SAAS,cAAc,mBAAmB,EAE1DL,EAAK,iBAAiB,SAAUM,CAAQ,EACxCH,EAAY,iBAAiB,QAASI,CAAY,EAClDF,EAAQ,iBAAiB,QAAS,IAAM,OAAO,SAAS,CAAC,IAAM,EAAG,SAAU,QAAQ,CAAC,CAAC,EAEtF,SAASC,EAASE,EAAG,CACnBA,EAAE,eAAc,EAEhB,MAAMC,EAAYT,EAAK,SAAS,UAAU,MAAM,OAGhD,GAFAA,EAAK,MAAK,EAEN,CAACS,EAAW,CACdf,EAAS,MAAM,CAAE,QAAS,+BAAiC,CAAA,EAC3D,MACD,CAEDQ,EAAQ,UAAY,GACpBD,EAAO,MAAM,QAAU,QACvBE,EAAY,MAAM,QAAU,OAC5BE,EAAQ,MAAM,QAAU,OAExBN,EAAU,EAAIU,EACdV,EAAU,KAAO,EACjBW,EAAWX,CAAS,CACtB,CAEA,SAASQ,GAAe,CACtBH,EAAe,MAAM,QAAU,QAC/BM,EAAWX,CAAS,CACtB,CAEA,eAAeW,EAAWC,EAAQ,CAChC,GAAI,CACF,MAAMC,EAAS,MAAMC,EAAM,IAAIf,EAAS,CAAE,OAAAa,EAAQ,EAC3C,KAAK,CAAC,CAAE,KAAAG,CAAM,IAAKA,CAAI,EAE9B,GAAIF,EAAO,KAAK,QAAU,EAAG,CAC3BlB,EAAS,QAAQ,CAAE,QAAS,6EAA+E,CAAA,EAC3G,MACD,CACDqB,EAAoBH,EAAO,IAAI,EAC/BI,EAAkBJ,EAAO,SAAS,CAEnC,OAAQK,EAAP,CACAvB,EAAS,MAAM,CAAE,QAAS,sBAAsBuB,IAAS,CAE7D,QAAY,CACRhB,EAAO,MAAM,QAAU,OACvBG,EAAe,MAAM,QAAU,MAChC,CACH,CAEA,SAASY,EAAkBE,EAAU,CAWnC,GAVIA,GAAYnB,EAAU,SAAWA,EAAU,MAC7CI,EAAY,MAAM,QAAU,OAC5BE,EAAQ,MAAM,QAAU,QACxBX,EAAS,QAAQ,CAAE,QAAS,4DAA8D,CAAA,IAG1FK,EAAU,MAAQ,EAClBI,EAAY,MAAM,QAAU,SAG1BJ,EAAU,KAAO,EAAG,CACtB,MAAMoB,EAAWjB,EAAQ,SAAS,GAAG,sBAAuB,EAAC,OAC7D,OAAO,SAAS,CAAE,KAAK,EAAG,IAAKiB,EAAW,EAAI,GAAI,SAAU,QAAQ,CAAC,CACtE,CACH,CAEA,SAASJ,EAAoBH,EAAQ,CACnCV,EAAQ,mBAAmB,YAAaU,EAAO,IAAIQ,CAAe,EAAE,KAAK,EAAE,CAAC,EAC5EzB,EAAS,QAAO,CAClB,CAEA,MAAMyB,EAAkB,CAAC,CACvB,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,IACS;AAAA;AAAA,sCAE6BN;AAAA;AAAA;AAAA,8CAGQC,WAAsBC;AAAA;AAAA;AAAA;AAAA;AAAA,8CAKtBC;AAAA;AAAA;AAAA;AAAA,8CAIAC;AAAA;AAAA;AAAA;AAAA,8CAIAC;AAAA;AAAA;AAAA;AAAA,8CAIAC;AAAA;AAAA;AAAA;AAAA;"}